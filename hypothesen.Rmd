---
title: "Hypothesen"
author: "Katharina Wagner"
date: "22 Januar 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r datensatz laden}

library(tidyverse)
library(haven)
library(sjlabelled)
library(knitr)
library(psych)

datensatz <- read.csv("datensatz.csv", sep = ";")
```

##Hypothesen√ºberpr√ºfung
```{r}
## Unterschiedshypothese
## H1) Die Emotionalisierung durch √úberschriften (in Kombination mit Bildern) in Utopia-Artikeln bewirkt einen Nudging-Effekt auf Rezipienten


by_n <- datensatz %>% filter(group.stimuli == "N")
by_e <- datensatz %>% filter(group.stimuli == "E")

#t.test(by_n$mind2_items ~ by_n$stimuli, paired = TRUE)
#t.test(datensatz$mind1_items ~ datensatz$stimuli)


#stimuli_n <- subset(datensatz, group.stimuli == "N")
#stimuli_e <- subset(datensatz, group.stimuli == "E")

boxplot(by_n$mind1_items, by_e$mind1_items, by_n$mind2_items, by_e$mind2_items,
       ylim = c(1, 6),
        col="#0c4c8a",
        main = "Nudging-Effekt der neutralen und emotionalen Gruppe",
        ylab = "Likert-Skala [1-6]"
        )
mtext(text=c("Pers√∂nliche Einstellung 1", "Pers√∂nliche Einstellung 2", "neutral", "emotional", "neutral", "emotional"),
   side = 1, line = c(1,1,2,2,2,2), at = c(1.5,3.5,1,2,3,4))

#describe(by_n$mind1_items)
#describe(by_n$mind2_items)

#ggsave("boxplot_nudging.jpg", plot = last_plot(),dpi = 300)

```

```{r}

## Zusammenhang 
##H2) Bei Rezipienten, die einen nachhaltigen Lebensstil pflegen, gibt es einen Nudging-Effekt.

datensatz <- transform(datensatz, behavior_group=cut(datensatz$behavior_items, breaks=c(-Inf, median(datensatz$behavior_items), Inf), labels=c("low", "high")))

nachhaltig <- datensatz %>% filter(behavior_group == "high")

cor.test(nachhaltig$behavior_items, nachhaltig$mind1_items)
cor.test(nachhaltig$behavior_items, nachhaltig$mind2_items)

#jmv::linReg(nachhaltig, dep=mind2_items, covs=c("behavior_items"),
#            blocks = list(list("behavior_items")),
#            r2Adj=T, stdEst=T, anova=T)

library(ggplot2)


ggplot(data = datensatz) +
  aes(x = behavior_items, y = mind1_items) +
  geom_point(color = "#0c4c8a") +
  theme_gray()+
  ylim(1, 6) +
  labs(x = "Nachhaltiges Verhalten", y = "Pers√∂nliche Einstellung 1",
     title = expression(atop("Zusammenhang zwischen nachhaligem Lebensstil", 
                           paste ("und Pers√∂nlicher Einstellung 1"))),
     subtitle = "Punktdiagramm")

#ggsave("cor_hyp21.png", width = 6, height = 4)

ggplot(data = datensatz) +
  aes(x = behavior_items, y = mind2_items) +
  geom_point(color = "#0c4c8a") +
  theme_gray()+
  ylim(1, 6) +
  labs(x = "Nachhaltiges Verhalten", y = "Pers√∂nliche Einstellung 2",
     title = expression(atop("Zusammenhang zwischen nachhaligem Lebensstil", 
                           paste ("und Pers√∂nlicher Einstellung 2"))),
     subtitle = "Punktdiagramm")


#ggsave("cor_hyp2.png", width = 6, height = 4)
```
#Das Verhalten wurde per Mediansplit in eine Gruppe mit hohem nachhaltigen Lebensstil und geringem nachhaltigen Lebensstil eingeteilt. Zur Hypothesen√ºberpr√ºfung wurde nur die Gruppe mit hohem nachhaltigen Lebensstil betrachtet. Die Berechnung erfolgte mittels Pearson Moment Korrelation.

#Pers√∂nliche Einstellung 1:
Es gibt einen signifikanten Zusammenhang zwischen der Einstellung und dem Verhalten vor den Stimuli (r(57)=.61, p < .001)

data:  nachhaltig$behavior_items and nachhaltig$mind1_items
t = 5.8678, df = 57, p-value = 2.366e-07
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.4242491 0.7516272
sample estimates:
      cor 
0.6136616 

#Pers√∂nliche Einstellung 2:
Es gibt einen signifikanten Zusammenhang zwischen der Einstellung und dem Verhalten nach den Stimuli (r(57)=.66, p < .001)

t = 6.5455, df = 57, p-value = 1.812e-08
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.4794023 0.7802582
sample estimates:
      cor 
0.6550646 


#Lineare Regression --> braucht man die hier?
Die lineare Regression zeigt, dass ein Modell mit einem Pr√§diktor F(1,57)= 42.8, p<.001, adj.r¬≤=419) signifikant wird. Das Modell kl√§rt somit 41.9% mehr Varianz auf, als der Mittelwert alleine. Ob sich jemand nachhaltig Verh√§lt, kann mit folgender Formel berechnet werden: 

```{r}
## Unterschied
## H3) Ein Nudging-Effekt tritt vermehrt bei tats√§chlichen Utopia-Nutzern auf.

#independent t-test
#Variable use_utopia_1: 0 und 1 rausfiltern und 2,3,4 einbeziehen. sind aber nur 9 Nutzer

utopia_user <- subset(datensatz, utopia == "1")
utopia_nuser <- subset(datensatz, utopia == "2")

#utopia_user <- datensatz %>% filter(use_utopia_1 == c("2","3","4","5"))
#utopia_nuser <- subset(datensatz, utopia == "0","1")

boxplot(utopia_user$mind1_items, utopia_nuser$mind1_items, utopia_user$mind2_items, utopia_nuser$mind2_items,
        ylim = c(1, 6),
        col="#0c4c8a",
        main = "Utopia bekannt vs unbekannt",
        ylab = "Likert-Skala [1-6]"
        )
mtext(text=c("Pers√∂nliche Einstellung 1", "Pers√∂nliche Einstellung 2", "Utopia bekannt", "Utopia unbekannt", "Utopia bekannt", "Utopia unbekannt"),
   side = 1, line = c(1,1,2,2,2,2), at = c(1.5,3.5,1,2,3,4))




```
##Problem
Eigentlich muss hier ein wilcox.test gemacht werden, funktioniert nicht, weil die Gruppen nicht definiert sind. Aber cor.test funktioniert, falls der √ºberhaupt etwas bringt.

```{r}

# Unterschied
## H4) Ein Nudging-Effekt tritt h√§ufiger bei Frauen auf.

#datensatz %>% filter(gender != 3)

#t.test(datensatz$gender ~ datensatz$mind1_items)
#t.test(datensatz$gender ~ datensatz$mind2_items)

male <- subset(datensatz, gender == "1")
female <- subset(datensatz, gender == "2")

boxplot(male$mind1_items, female$mind1_items, male$mind2_items, female$mind2_items,
        ylim = c(1, 6),
        col="#0c4c8a",
        main = "Nudging-Effekt bei M√§nnern und Frauen",
        ylab = "Likert-Skala [1-6]"
        )
mtext(text=c("Pers√∂nliche Einstellung 1", "Pers√∂nliche Einstellung 2", "M√§nner", "Frauen", "M√§nner", "Frauen"),
   side = 1, line = c(1,1,2,2,2,2), at = c(1.5,3.5,1,2,3,4))

describe(male$mind1_items)
describe(male$mind2_items)

describe(female$mind1_items)
describe(female$mind2_items)

```


```{r}
## Zusammenhang
## H5) Es besteht ein Zusammenhang zwischen dem nachhaltigen Verhalten eines Nutzers und der empfundenen Emotionalisierung.


#datensatz <- transform(datensatz, emotional_group=cut(datensatz$stimuli, breaks=c(-Inf, median(datensatz$stimuli), Inf), labels=c("low", "high")))

#emotional <- datensatz %>% filter(emotional_group == "high")

cor.test(datensatz$behavior_items, datensatz$stimuli)


ggplot(data = datensatz) +
  aes(x = behavior_items, y = stimuli) +
  geom_point() +
  theme_grey()+
  #ylim(1, 6) +
  labs(x = "Nachhaltiges Verhalten", y = "Stimuli",
     title = expression(atop("Zusammenhang zwischen nachhaligem Lebensstil", 
                           paste ("und empfundener Emotionalisierung"))),
     subtitle = "Punktdiagramm")

ggsave("cor_hyp5.png", width = 6, height = 4)

median(datensatz$behavior_items)

##Problem: ü°™ funktioniert alles nicht,welche Variable f√ºrÔøΩÔøΩÔøΩ welche Variable f√ºr die empfundene Emtionalisierung?

```